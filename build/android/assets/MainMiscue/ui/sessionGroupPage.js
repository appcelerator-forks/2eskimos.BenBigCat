var r_miscue=require('/MainMiscue/miscue.js'),r_loadingScreen=require('/MainMiscue/ui/loadingScreen'),r_styles=require('/MainMiscue/ui/styles'),r_HomeScreen=require('/MainMiscue/ui/HomeScreen'),r_searchSession=require('/MainMiscue/ui/searchSession');(function(){r_miscue.tt.ui.createGroupWindow=function(usrname,token,user_Id,button_Id,menuItemKey){function orientionChangeMode(e){return;var screenRes=r_loadingScreen.backgroundImageHeightWidthPxToDp();screenBackgroundImage[1].width=screenRes[0],Ti.Platform.displayCaps.platformWidth>Ti.Platform.displayCaps.platformHeight?(Inch>=InchValue||'ipad'==osname)&&(screenBackgroundImage[1].height=screenRes[1],Ti.API.info('or change landscape'+screenBackgroundImage[1].height),backView.height=70,backView.width=135):('ipad'==osname||'iphone'==osname?(screenBackgroundImage[1].height=Titanium.Platform.displayCaps.platformHeight-Titanium.Platform.displayCaps.platformHeight/2.5,Ti.API.info('or change portrair ipad and iPhone'+screenBackgroundImage[1].height)):(screenBackgroundImage[1].height=Titanium.Platform.displayCaps.platformHeight/(Titanium.Platform.displayCaps.dpi/120),Ti.API.info('or change portrair android'+screenBackgroundImage[1].height)),Inch>=InchValue&&('iphone'==osname||'ipad'==osname?(screenBackgroundImage[1].height=Titanium.Platform.displayCaps.platformHeight,Ti.API.info('or change inch > value portrair iphone or ipad'+screenBackgroundImage[1].height)):(screenBackgroundImage[1].height=Titanium.Platform.displayCaps.platformHeight/(Titanium.Platform.displayCaps.dpi/100),Ti.API.info('or change inch > value portrair android'+screenBackgroundImage[1].height)),backView.height=80,backView.width=145))}function tableViewClickEvent(e){Ti.API.log('Chatteboxes sessionGroupPage.js called','Chatterboxes sessionGroupPage.js called');var rowid=e.rowData.id;clickCount++;var db=Titanium.Database.open('Miscue'),learnercheckrow=db.execute('SELECT * FROM Learner T1  WHERE userId = ? AND deleted = ? AND groupGuid = (SELECT groupGuid FROM LearnerGroup T2 WHERE groupName = ? AND loginUserId = ?)',user_Id,'no',rowid,user_Id);if(1<=learnercheckrow.rowCount){if(db.close(),1==clickCount){var learnerwindow=r_miscue.tt.ui.createLearnerWindow(usrname,rowid,token,button_Id,user_Id,menuItemKey);learnerwindow.open()}setTimeout(function(){clickCount=0,groupWind.remove(screenBackgroundImage[0]),screenBackgroundImage[0]=null},500),groupWind.close(),tableView.removeEventListener('click',tableViewClickEvent)}else{db.close();var labelArray=[];labelArray.title=['Alert','Alert'],labelArray.message=['no_Learner_Message','There are no learners in this class'],labelArray[1]=['Ok','Ok'];var dialog=r_HomeScreen.createLocalizedAlertDialog(labelArray,usrname);dialog.show(),setTimeout(function(){clickCount=0},500)}}var pWidth=Ti.Platform.displayCaps.platformWidth,db=Titanium.Database.open('Miscue'),homerow=db.execute('SELECT * FROM UserSetting where loginId =?',user_Id),osname=Ti.Platform.osname,schoolnames=homerow.fieldByName('schoolName'),backpage=homerow.fieldByName('backPage'),backcolour=homerow.fieldByName('backgroundColor'),fontcolour=homerow.fieldByName('fontColor'),pagefontfamily=homerow.fieldByName('charFont'),groupWindowBackgroundImage=homerow.fieldByName('selectionPagebackgroundURL'),dec=Ti.Utils.base64decode(schoolnames),backView=r_loadingScreen.createBackButton(fontcolour,homerow.fieldByName('backImageURL'));homerow.close(),homerow=null,db.close(),db=null;var iOS7=r_loadingScreen.isiOS7Plus(),groupWind=Ti.UI.createWindow({navBarHidden:!0,tabBarHidden:!0,backgroundColor:'white',fullscreen:!0}),Inch=r_loadingScreen.screenInch(),screenBackgroundImage=r_loadingScreen.mainBackgroundImage(groupWindowBackgroundImage);groupWind.add(screenBackgroundImage[0]);var screenRes=r_loadingScreen.backgroundImageHeightWidthPxToDp();screenBackgroundImage[1].height='iphone'==osname||'ipad'==osname?Titanium.Platform.displayCaps.platformHeight:Titanium.Platform.displayCaps.platformHeight/(Titanium.Platform.displayCaps.dpi/120),screenBackgroundImage[1].width=screenRes[0],Ti.Platform.displayCaps.platformWidth>Ti.Platform.displayCaps.platformHeight?(backView.height=70,backView.width=135,screenBackgroundImage[1].height=screenRes[1],Ti.API.info('Initial height for landscape '+screenBackgroundImage[1].height)):('ipad'==osname||'iphone'==osname?(screenBackgroundImage[1].height=Titanium.Platform.displayCaps.platformHeight-Titanium.Platform.displayCaps.platformHeight/2.5,Ti.API.info('Initial height for portrait ipad and iPhone '+screenBackgroundImage[1].height)):(screenBackgroundImage[1].height=Titanium.Platform.displayCaps.platformHeight/(Titanium.Platform.displayCaps.dpi/120),Ti.API.info('Initial height for portrait android'+screenBackgroundImage[1].height)),Inch>=InchValue&&('iphone'==osname||'ipad'==osname?(screenBackgroundImage[1].height=Titanium.Platform.displayCaps.platformHeight,Ti.API.info('Inch Height for iphone or ipad(portrait)'+screenBackgroundImage[1].height)):(screenBackgroundImage[1].height=Titanium.Platform.displayCaps.platformHeight/(Titanium.Platform.displayCaps.dpi/100),Ti.API.info('Inch Height for android(portrait)'+screenBackgroundImage[1].height)),backView.height=80,backView.width=145)),7<=iOS7&&(groupWind.top='20dp'),'iphone'==osname&&(backView.height=48,backView.width=78),Inch<InchValue&&'android'==osname?(backView.height=50,backView.width=80,groupWind.orientationModes=[Titanium.UI.PORTRAIT]):'android'==osname&&(groupWind.orientationModes=[Titanium.UI.PORTRAIT]),Ti.Gesture.addEventListener('orientationchange',orientionChangeMode);var top=r_loadingScreen.titleLabeltop(),networkCheck=function(e){if(!0==e.online||1==e.online){var db=Titanium.Database.open('Miscue'),miscueSavePendingSessionToServerRow=db.execute('SELECT * FROM MiscueSession WHERE userId = ? AND  (lastSavedToServerDate < lastModifiedDate OR lastSavedToServerDate = ?)',user_Id,'null'),interval=1500*miscueSavePendingSessionToServerRow.rowCount;if(0<miscueSavePendingSessionToServerRow.rowCount){db.close(),groupWind.touchEnabled=!1;var labelArray=[];labelArray.message=['loading_Indicator','Please wait..'],r_loadingScreen.showActivity(labelArray.message,username),r_searchSession.createSubmitPendingSessionToServer(user_Id,token,groupWind)}else db.close()}};groupWind.addEventListener('close',function(e){Ti.Gesture.removeEventListener('orientationchange',orientionChangeMode)}),backView.addEventListener('click',function(e){tableView.removeEventListener('click',tableViewClickEvent),groupWind.remove(selectGroupLabel),tableView.removeAllChildren(),groupWind.remove(backView),groupWind.remove(tableView),groupWind.remove(screenBackgroundImage[0]),screenBackgroundImage[0]=null,selectGroupLabel=null,backView=null,tableView=null;var miscueWin=r_miscue.tt.ui.createmiscueMenuPage(usrname,token,menuItemKey,user_Id);miscueWin.open(),groupWind.close(),groupWind=null}),'android'==Ti.Platform.osname&&groupWind.addEventListener('android:back',function(){tableView.removeEventListener('click',tableViewClickEvent),groupWind.remove(selectGroupLabel),tableView.removeAllChildren(),groupWind.remove(backView),groupWind.remove(tableView),groupWind.remove(screenBackgroundImage[0]),screenBackgroundImage[0]=null;var miscueWin=r_miscue.tt.ui.createmiscueMenuPage(usrname,token,button_Id,user_Id);miscueWin.open(),groupWind.close(),selectGroupLabel=null,backView=null,tableView=null,groupWind=null});var selectGroupLabel=Ti.UI.createLabel({color:fontcolour,top:'5%',width:'100%',font:{fontSize:Inch>=InchValue?'28dp':'18dp',fontWeight:'bold',fontFamily:pagefontfamily},textAlign:'center',text:'SELECT CLASS',touchEnabled:!1}),tableView=Ti.UI.createTableView(r_miscue.tt.combine(r_styles.$$.TableView,{top:top[2],separatorColor:'transparent',backgroundColor:'transparent',left:'5%',right:'5%'}));if('iphone'==osname||'ipad'==osname){var footerView=Ti.UI.createView({height:0});tableView.footerView=footerView,tableView.footerTitle=''}groupWind.add(selectGroupLabel),groupWind.add(backView),groupWind.add(tableView);var db=Titanium.Database.open('Miscue'),holddatavar=db.execute('SELECT * FROM LearnerGroup WHERE loginUserId = ? AND deleted = ?',user_Id,'no');tvData=[];for(var i=0;i<holddatavar.rowCount;i++){var groupname=holddatavar.fieldByName('groupName'),groupids=holddatavar.fieldByName('groupGuid');Ti.API.log('Group name sessionGroupPage.js is :: ',groupname),Ti.API.log('Group ids sessionGroupPage.js are :: ',groupids);var row=Ti.UI.createTableViewRow(r_miscue.tt.combine(r_styles.$$.TableViewRow,{height:'65dp',id:groupname}));groupnamelabel=groupname.replace('&quot;','\''),spacing='8dp',imgDimensions='50dp';var groupLabel=Ti.UI.createLabel({bottom:'10dp',text:groupnamelabel,color:fontcolour,font:{fontSize:Inch>=InchValue?'28dp':'18dp',fontWeight:'bold',fontFamily:pagefontfamily},left:spacing}),separatorLine=Ti.UI.createView({bottom:'1%',backgroundColor:'#A9A9A9',height:'3dp',width:'100%'});row.add(groupLabel),row.add(separatorLine),tvData.push(row),holddatavar.next()}db.close(),tableView.setData(tvData);var clickCount;return groupWind.addEventListener('focus',function(e){clickCount=0}),tableView.addEventListener('click',tableViewClickEvent),groupWind}})();var r_sessionLearnerPage=require('/MainMiscue/ui/sessionLearnerPage');