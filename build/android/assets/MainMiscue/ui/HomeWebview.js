(function(){tt.ui.createHomeWebview=function(menuItem_key,userName,osname,textValue,token,menuItem_keyDuplicate,user_Id){function getOrientation(orientVal){var value;return value=1===orientVal?1:4===orientVal?2:2===orientVal?3:3===orientVal?4:0,value}function orientionChangeMode(e){return;var orientVal=e.source.orientation,orientationVal=getOrientation(orientVal);if(orientationVal!=orientCount&&0!=orientationVal){Ti.Platform.displayCaps.platformWidth>Ti.Platform.displayCaps.platformHeight?(backView.height=70,backView.width=135):Inch>=InchValue&&(backView.height=80,backView.width=145);var screenRes=r_loadingScreen.backgroundImageHeightWidthPxToDp();screenBackgroundImage[1].width=screenRes[0],Ti.Platform.displayCaps.platformWidth>Ti.Platform.displayCaps.platformHeight?(backButton.width='86%',backButton.width='2%',refreshButton.width='86%',refreshButton.width='2%',refreshButton.left='4.5%',forwardButton.width='86%',forwardButton.width='2%',forwardButton.left='8%',Inch>=InchValue&&(screenBackgroundImage[1].height=screenRes[1],Ti.API.info('or change landscape'+screenBackgroundImage[1].height))):(refreshButton.width='89%',refreshButton.width='7%',backButton.width='89%',backButton.width='7%',refreshButton.left='11%',forwardButton.width='89%',forwardButton.width='7%',forwardButton.left='21%','ipad'==osname||'iphone'==osname?(screenBackgroundImage[1].height=Titanium.Platform.displayCaps.platformHeight-Titanium.Platform.displayCaps.platformHeight/2.5,Ti.API.info('or change portrair ipad and iPhone'+screenBackgroundImage[1].height)):(screenBackgroundImage[1].height=Titanium.Platform.displayCaps.platformHeight/(Titanium.Platform.displayCaps.dpi/120),Ti.API.info('or change portrair android'+screenBackgroundImage[1].height)),Inch>=InchValue&&('iphone'==osname||'ipad'==osname?(screenBackgroundImage[1].height=Titanium.Platform.displayCaps.platformHeight,Ti.API.info('or change inch > value portrair iphone or ipad'+screenBackgroundImage[1].height)):(screenBackgroundImage[1].height=Titanium.Platform.displayCaps.platformHeight/(Titanium.Platform.displayCaps.dpi/100),Ti.API.info('or change inch > value portrair android'+screenBackgroundImage[1].height))))}}Ti.API.info('home web view');var pWidth=Ti.Platform.displayCaps.platformWidth,db=Titanium.Database.open('Miscue'),homerow=db.execute('SELECT * FROM UserSetting where loginId =?',user_Id),schoolnames=homerow.fieldByName('schoolName'),backpage=homerow.fieldByName('backPage'),backcolour=homerow.fieldByName('backgroundColor'),fontcolour=homerow.fieldByName('fontColor'),pagefontfamily=homerow.fieldByName('charFont'),webViewWindowBackgroundImage=homerow.fieldByName('selectionPagebackgroundURL'),dec=Ti.Utils.base64decode(schoolnames),backView=r_loadingScreen.createBackButton(fontcolour,homerow.fieldByName('backImageURL'));homerow.close(),homerow=null;var homescrn=db.execute('SELECT * FROM UserMenuItem where menuItemKey = ? AND userId = ?',menuItem_key,user_Id),hmlink=homescrn.fieldByName('Link'),hmimg=homescrn.fieldByName('label_name');homescrn.close(),homescrn=null,db.close(),db=null;var iOS7=r_loadingScreen.isiOS7Plus(),homeWebWin=Ti.UI.createWindow({fullscreen:!1,navBarHidden:!0,backgroundColor:'white',title:''});7<=iOS7&&(homeWebWin.top='20dp');var screenBackgroundImage=r_loadingScreen.mainBackgroundImage(webViewWindowBackgroundImage),screenRes=r_loadingScreen.backgroundImageHeightWidthPxToDp();screenBackgroundImage[1].height='iphone'==osname||'ipad'==osname?Titanium.Platform.displayCaps.platformHeight:Titanium.Platform.displayCaps.platformHeight/(Titanium.Platform.displayCaps.dpi/120),screenBackgroundImage[1].width=screenRes[0],homeWebWin.add(screenBackgroundImage[0]);var Inch=r_loadingScreen.screenInch();Ti.Platform.displayCaps.platformWidth>Ti.Platform.displayCaps.platformHeight?(Inch>=InchValue&&(backView.height=70,backView.width=135),screenBackgroundImage[1].height=screenRes[1],Ti.API.info('Initial height for landscape '+screenBackgroundImage[1].height)):('ipad'==osname||'iphone'==osname?(screenBackgroundImage[1].height=Titanium.Platform.displayCaps.platformHeight-Titanium.Platform.displayCaps.platformHeight/2.5,Ti.API.info('Initial height for portrait ipad and iPhone '+screenBackgroundImage[1].height)):(screenBackgroundImage[1].height=Titanium.Platform.displayCaps.platformHeight/(Titanium.Platform.displayCaps.dpi/120),Ti.API.info('Initial height for portrait android'+screenBackgroundImage[1].height)),Inch>=InchValue&&('iphone'==osname||'ipad'==osname?(screenBackgroundImage[1].height=Titanium.Platform.displayCaps.platformHeight,Ti.API.info('Inch Height for iphone or ipad(portrait)'+screenBackgroundImage[1].height)):(screenBackgroundImage[1].height=Titanium.Platform.displayCaps.platformHeight/(Titanium.Platform.displayCaps.dpi/100),Ti.API.info('Inch Height for android(portrait)'+screenBackgroundImage[1].height)),backView.height=80,backView.width=145)),'iphone'==osname&&(backView.height=48,backView.width=78),Inch<InchValue&&'android'==osname?(backView.height=50,backView.width=80,homeWebWin.orientationModes=[Titanium.UI.PORTRAIT]):'android'==osname&&(homeWebWin.orientationModes=[Titanium.UI.PORTRAIT]);var isProcessInProgress=!0;backView.addEventListener('click',function(e){if(!0==isProcessInProgress){isProcessInProgress=!1;var labelArray=[];labelArray.message=['loading_Indicator','Loading..'],r_loadingScreen.showActivity(labelArray.message,userName),refreshButton.removeEventListener('click',function(e){}),backButton.removeEventListener('click',function(){}),forwardButton.removeEventListener('click',function(){}),Ti.Gesture.removeEventListener('orientationchange',orientionChangeMode),setTimeout(function(){homeWebWin.remove(webViewContainer),homeWebWin.remove(view),homeWebWin.remove(backView),homeWebWin.remove(webViewLabel),webViewContainer.remove(borderLineViewContainer),webViewContainer.remove(backButton),webViewContainer.remove(forwardButton),webViewContainer.remove(refreshButton),homeWebWin.remove(webViewContainer),homeWebWin.remove(screenBackgroundImage[0]),screenBackgroundImage[0]=null,borderLineViewContainer=null,backButton=null,refreshButton=null,forwardButton=null,view=null,webViewContainer=null,webView=null,backView=null,top=null,Inch=null;var refcheck=2,wind=tt.ui.createHomeScreen(userName,token,refcheck);wind.open(),r_loadingScreen.hideActivity(),homeWebWin.close(),homeWebWin=null},500)}}),'android'==Ti.Platform.osname&&homeWebWin.addEventListener('android:back',function(){if(!0==isProcessInProgress){isProcessInProgress=!1,refreshButton.removeEventListener('click',function(e){}),backButton.removeEventListener('click',function(){}),forwardButton.removeEventListener('click',function(){}),Ti.Gesture.removeEventListener('orientationchange',orientionChangeMode),homeWebWin.remove(view),homeWebWin.remove(webView),homeWebWin.remove(backView),homeWebWin.remove(webViewLabel),webViewContainer.remove(borderLineViewContainer),webViewContainer.remove(backButton),webViewContainer.remove(forwardButton),webViewContainer.remove(refreshButton),homeWebWin.remove(webViewContainer),homeWebWin.remove(screenBackgroundImage[0]),screenBackgroundImage[0]=null,borderLineViewContainer=null,backButton=null,refreshButton=null,forwardButton=null,view=null,webViewContainer=null,webView=null,backView=null;var refcheck=2,wind=tt.ui.createHomeScreen(userName,token,refcheck);wind.open(),homeWebWin.close(),homeWebWin=null,top=null,Inch=null}});var top=r_loadingScreen.titleLabeltop(),webViewLabel=Ti.UI.createLabel({color:'#CEDEE6',backgroundColor:'transparent ',top:'5%',width:'100%',font:{fontSize:Inch>=InchValue?'28dp':'18dp',fontWeight:'bold',fontFamily:pagefontfamily},textAlign:'center',text:textValue});homeWebWin.add(webViewLabel),homeWebWin.add(backView);var webViewContainer=Ti.UI.createView({backgroundColor:'#2F9DCF',bottom:'0dp',width:'100%',height:'5%'}),borderLineViewContainer=Ti.UI.createView({backgroundColor:'#aaa',top:'0dp',width:'100%',height:'5%'}),backButton=Titanium.UI.createButton({backgroundColor:'NONE',bottom:0,left:'1%',verticalAlign:Titanium.UI.TEXT_VERTICAL_ALIGNMENT_CENTER,height:'90%',width:'7%',backgroundImage:'/images/phase5/BACKWARDSPURPLE.png'}),refreshButton=Titanium.UI.createButton({backgroundColor:'NONE',backgroundImage:'/images/phase5/PAGEREFRESHPURPLE.png',bottom:0,left:'11%',verticalAlign:Titanium.UI.TEXT_VERTICAL_ALIGNMENT_CENTER,height:'89%',width:'7%'}),forwardButton=Titanium.UI.createButton({backgroundColor:'NONE',bottom:0,left:'21%',verticalAlign:Titanium.UI.TEXT_VERTICAL_ALIGNMENT_CENTER,height:'90%',width:'7%',backgroundImage:'/images/phase5/FORWARDSPURPLE.png'});Ti.Platform.displayCaps.platformWidth>Ti.Platform.displayCaps.platformHeight&&(backButton.width='86%',backButton.width='2%',refreshButton.width='86%',refreshButton.width='2%',refreshButton.left='4.5%',forwardButton.width='86%',forwardButton.width='2%',forwardButton.left='8%'),refreshButton.addEventListener('click',function(){webView.reload()}),backButton.addEventListener('click',function(){webView.goBack()}),forwardButton.addEventListener('click',function(){webView.goForward()}),webViewContainer.add(borderLineViewContainer),webViewContainer.add(backButton),webViewContainer.add(forwardButton),webViewContainer.add(refreshButton);var view=Ti.UI.createView({top:top[2],left:0,backgroundColor:'transparent',height:'80%'}),webView=Titanium.UI.createWebView({backgroundColor:'white',hideLoadIndicator:!0,canGoBack:!0,canGoForward:!0,url:hmlink,height:'100%',width:'100%'});view.add(webView),homeWebWin.add(view);var style;style='iPhone OS'===Ti.Platform.name?Titanium.UI.iPhone.ActivityIndicatorStyle.BIG:Titanium.UI.ActivityIndicatorStyle.DARK;var activityIndicator=Ti.UI.createActivityIndicator({color:'#aaa',font:{fontFamily:'Helvetica Neue',fontSize:'21dp',fontWeight:'bold',fontFamily:'Roboto',fontSize:'21dp',fontWeight:'bold'},style:style,height:'auto',width:'auto',indicatorColor:'#0000FF',indicatorDiameter:70});homeWebWin.add(webViewContainer),view.addEventListener('beforeload',function(){view.add(activityIndicator),activityIndicator.show()}),webView.addEventListener('load',function(){activityIndicator.hide()});var orientCount=6;return Ti.Gesture.addEventListener('orientationchange',orientionChangeMode),homeWebWin}})();